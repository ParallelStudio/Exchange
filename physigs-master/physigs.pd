#N canvas 322 77 863 456 10;
#N canvas 592 15 774 709 physigs-linkforces 0;
#X obj 71 21 inlet;
#X obj 220 58 outlet;
#X obj 71 160 switch~;
#X text 289 172 get state;
#X obj 220 29 bang~;
#X text 143 646 set new forces;
#X text 390 45 Formula: F = -[k*(|p2-p1|- len) + D*(vel2-vel1)]*(p2-p1)/|p2-p1|
;
#X obj 99 522 tabreceive~ \$1-link-k;
#X obj 72 522 *~;
#X text 21 419 substract length;
#X obj 172 450 /~;
#X obj 272 441 /~;
#X text 313 443 normalized difference vector (x \, y);
#X obj 146 570 *~;
#X obj 409 575 *~;
#X text 407 640 set new forces;
#X obj 506 273 tabread~ \$1-pos-y;
#X obj 367 271 tabread~ \$1-pos-y;
#X obj 232 270 tabread~ \$1-pos-x;
#X obj 72 268 tabread~ \$1-pos-x;
#X obj 145 625 tabsend~ \$1-link-force-x;
#X obj 410 619 tabsend~ \$1-link-force-y;
#X text 121 492 TODO: why not negative?;
#N canvas 0 0 687 386 velocity-difference 0;
#X obj 71 178 -~;
#X obj 344 179 -~;
#X obj 71 143 tabread~ \$1-vel-x;
#X obj 231 145 tabread~ \$1-vel-x;
#X obj 343 144 tabread~ \$1-vel-y;
#X obj 482 146 tabread~ \$1-vel-y;
#X obj 71 30 inlet~;
#X obj 231 30 inlet~;
#X obj 72 233 outlet~;
#X obj 344 232 outlet~;
#X obj 474 37 inlet~;
#X obj 71 205 *~;
#X obj 345 207 *~;
#X text 485 19 damping;
#X connect 0 0 11 0;
#X connect 1 0 12 0;
#X connect 2 0 0 0;
#X connect 3 0 0 1;
#X connect 4 0 1 0;
#X connect 5 0 1 1;
#X connect 6 0 4 0;
#X connect 6 0 2 0;
#X connect 7 0 5 0;
#X connect 7 0 3 0;
#X connect 10 0 12 1;
#X connect 10 0 11 1;
#X connect 11 0 8 0;
#X connect 12 0 9 0;
#X restore 444 406 pd velocity-difference;
#X obj 610 406 tabreceive~ \$1-link-D;
#X obj 454 499 *~;
#X obj 390 497 *~;
#X obj 72 217 tabreceive~ \$1-link-m2;
#X obj 232 217 tabreceive~ \$1-link-m1;
#X obj 72 438 -~;
#X msg 85 133 set \$1 1 1;
#X obj 85 112 r \$0-num-links;
#X obj 90 399 tabreceive~ \$1-link-length;
#N canvas 0 0 543 306 get-link-force-y 0;
#X obj 109 45 inlet~;
#X obj 108 173 outlet~;
#X obj 150 105 tabreceive~ \$1-link-force-y;
#X text 186 43 order forcing;
#X connect 0 0 1 0;
#X connect 2 0 1 0;
#X restore 409 595 pd get-link-force-y;
#N canvas 0 0 543 306 get-link-force-x 0;
#X obj 109 45 inlet~;
#X obj 108 173 outlet~;
#X text 186 43 order forcing;
#X obj 149 105 tabreceive~ \$1-link-force-x;
#X connect 0 0 1 0;
#X connect 3 0 1 0;
#X restore 145 594 pd get-link-force-x;
#N canvas 292 57 436 349 get-vector-length-and-diff 0;
#X obj 81 64 inlet~;
#X obj 134 64 inlet~;
#X obj 221 65 inlet~;
#X obj 273 65 inlet~;
#X text 86 43 x1;
#X text 135 44 x2;
#X text 220 46 y1;
#X text 274 49 y2;
#X obj 82 128 -~;
#X obj 221 98 -~;
#X obj 220 126 *~;
#X obj 82 152 *~;
#X obj 81 186 +~;
#X obj 81 216 sqrt~;
#X text 27 217 |p2-p1|;
#X obj 81 246 outlet~;
#X obj 174 247 outlet~;
#X obj 267 245 outlet~;
#X connect 0 0 8 0;
#X connect 1 0 8 1;
#X connect 2 0 9 0;
#X connect 3 0 9 1;
#X connect 8 0 11 0;
#X connect 8 0 11 1;
#X connect 8 0 16 0;
#X connect 9 0 10 0;
#X connect 9 0 10 1;
#X connect 9 0 17 0;
#X connect 10 0 12 1;
#X connect 11 0 12 0;
#X connect 12 0 13 0;
#X connect 13 0 15 0;
#X restore 71 324 pd get-vector-length-and-diff;
#N canvas 0 0 456 205 dsp-guard 0;
#X obj 105 49 r pd;
#X obj 105 70 route dsp;
#X obj 66 91 spigot;
#X obj 66 26 inlet;
#X obj 66 119 outlet;
#X text 123 26 blocks messages while dsp is off;
#X msg 121 91 1;
#X connect 0 0 1 0;
#X connect 1 0 2 1;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 6 0 2 1;
#X restore 71 90 pd dsp-guard;
#X obj 71 62 b;
#X connect 0 0 37 0;
#X connect 4 0 1 0;
#X connect 7 0 8 1;
#X connect 8 0 13 0;
#X connect 8 0 14 0;
#X connect 10 0 13 1;
#X connect 10 0 26 0;
#X connect 11 0 14 1;
#X connect 11 0 25 0;
#X connect 13 0 34 0;
#X connect 14 0 33 0;
#X connect 16 0 35 3;
#X connect 17 0 35 2;
#X connect 18 0 35 1;
#X connect 19 0 35 0;
#X connect 23 0 26 1;
#X connect 23 1 25 1;
#X connect 24 0 23 2;
#X connect 25 0 14 0;
#X connect 26 0 13 0;
#X connect 27 0 19 0;
#X connect 27 0 17 0;
#X connect 27 0 23 0;
#X connect 28 0 18 0;
#X connect 28 0 16 0;
#X connect 28 0 23 1;
#X connect 29 0 8 0;
#X connect 30 0 2 0;
#X connect 31 0 30 0;
#X connect 32 0 29 1;
#X connect 33 0 21 0;
#X connect 34 0 20 0;
#X connect 35 0 11 1;
#X connect 35 0 10 1;
#X connect 35 0 29 0;
#X connect 35 1 10 0;
#X connect 35 2 11 0;
#X connect 36 0 2 0;
#X connect 37 0 36 0;
#X restore 199 72 pd physigs-linkforces;
#N canvas 286 16 1080 630 linkforces-to-mass-forces 0;
#X obj 195 196 f 0;
#X obj 224 197 + 1;
#X obj 195 172 until;
#X obj 195 88 t b b;
#X obj 245 23 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X text 275 219 go through all links;
#X obj 195 16 inlet;
#X msg 233 173 0;
#X obj 195 217 t f f f f;
#X obj 539 442 +;
#X obj 608 443 tabread \$1-link-force-x;
#X obj 539 416 tabread \$1-force-x;
#X obj 539 465 tabwrite \$1-force-x;
#X text 802 311 get mass id;
#X text 723 281 link id;
#X text 755 335 mass id;
#X obj 777 442 +;
#X obj 777 416 tabread \$1-force-y;
#X obj 777 465 tabwrite \$1-force-y;
#X obj 846 443 tabread \$1-link-force-y;
#X obj 668 310 tabread \$1-link-m2;
#X obj 808 442 * -1;
#X obj 572 443 * -1;
#X obj 195 151 max;
#X obj 195 130 f 64;
#X obj 220 108 r \$0-num-links;
#X obj 668 283 t f f f;
#X obj 668 337 t f f f f;
#X obj 102 444 tabread \$1-link-force-x;
#X obj 66 417 tabread \$1-force-x;
#X obj 66 466 tabwrite \$1-force-x;
#X text 329 312 get mass id;
#X text 250 282 link id;
#X text 282 336 mass id;
#X obj 304 443 +;
#X obj 304 417 tabread \$1-force-y;
#X obj 304 466 tabwrite \$1-force-y;
#X obj 343 444 tabread \$1-link-force-y;
#X obj 195 284 t f f f;
#X obj 195 338 t f f f f;
#X obj 195 311 tabread \$1-link-m1;
#X obj 66 444 +;
#X connect 0 0 1 0;
#X connect 0 0 8 0;
#X connect 1 0 0 1;
#X connect 2 0 0 0;
#X connect 3 0 24 0;
#X connect 3 1 7 0;
#X connect 4 0 3 0;
#X connect 6 0 3 0;
#X connect 7 0 0 1;
#X connect 8 0 38 0;
#X connect 8 2 26 0;
#X connect 9 0 12 0;
#X connect 10 0 22 0;
#X connect 11 0 9 0;
#X connect 16 0 18 0;
#X connect 17 0 16 0;
#X connect 19 0 21 0;
#X connect 20 0 27 0;
#X connect 21 0 16 1;
#X connect 22 0 9 1;
#X connect 23 0 2 0;
#X connect 24 0 23 0;
#X connect 25 0 24 1;
#X connect 26 0 20 0;
#X connect 26 1 10 0;
#X connect 26 2 19 0;
#X connect 27 0 11 0;
#X connect 27 1 12 1;
#X connect 27 2 17 0;
#X connect 27 3 18 1;
#X connect 28 0 41 1;
#X connect 29 0 41 0;
#X connect 34 0 36 0;
#X connect 35 0 34 0;
#X connect 37 0 34 1;
#X connect 38 0 40 0;
#X connect 38 1 28 0;
#X connect 38 2 37 0;
#X connect 39 0 29 0;
#X connect 39 1 30 1;
#X connect 39 2 35 0;
#X connect 39 3 36 1;
#X connect 40 0 39 0;
#X connect 41 0 30 0;
#X restore 199 104 pd linkforces-to-mass-forces;
#N canvas 0 0 648 516 make-link 0;
#X obj 227 56 inlet;
#X msg 227 274 \$1 \$2;
#X obj 227 298 s \$1-link-m1;
#X msg 227 334 \$1 \$3;
#X obj 227 358 s \$1-link-m2;
#X obj 228 409 s \$1-link-k;
#X msg 228 385 \$1 \$4;
#X obj 116 261 list split 1;
#X floatatom 116 284 5 0 0 0 last_link-id - -;
#X obj 439 150 inlet;
#X obj 439 178 b;
#X text 239 36 m1 \, m2 \, k \, D;
#X text 234 239 lid \, m1 \, m2 \, k \, D;
#X msg 228 432 \$1 \$5;
#X obj 228 456 s \$1-link-D;
#N canvas 0 0 386 287 enumerate 0;
#N canvas 473 338 450 300 count 0;
#X obj 131 154 f 0;
#X obj 156 153 + 1;
#X obj 131 183 outlet;
#X obj 131 59 inlet;
#X obj 131 96 b;
#X obj 178 61 inlet;
#X obj 178 98 b;
#X msg 147 133 0;
#X connect 0 0 1 0;
#X connect 0 0 2 0;
#X connect 1 0 0 1;
#X connect 3 0 4 0;
#X connect 4 0 0 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 0 1;
#X restore 137 130 pd count;
#X obj 56 155 list prepend;
#X obj 56 100 t a b;
#X obj 56 71 inlet;
#X obj 190 76 inlet;
#X obj 56 191 outlet;
#X connect 0 0 1 1;
#X connect 1 0 5 0;
#X connect 2 0 1 0;
#X connect 2 1 0 0;
#X connect 3 0 2 0;
#X connect 4 0 0 1;
#X restore 227 218 pd enumerate;
#X obj 308 177 r \$0-reset-links;
#X connect 0 0 15 0;
#X connect 1 0 2 0;
#X connect 3 0 4 0;
#X connect 6 0 5 0;
#X connect 7 0 8 0;
#X connect 9 0 10 0;
#X connect 10 0 15 1;
#X connect 13 0 14 0;
#X connect 15 0 1 0;
#X connect 15 0 3 0;
#X connect 15 0 6 0;
#X connect 15 0 7 0;
#X connect 15 0 13 0;
#X connect 16 0 15 1;
#X restore 42 228 pd make-link;
#X msg 142 206 reset;
#N canvas 380 81 780 444 particle-system-state 0;
#X obj 62 117 table \$1-mass 64;
#X obj 62 41 table \$1-pos-x 64;
#X obj 62 63 table \$1-vel-x 64;
#X obj 62 85 table \$1-force-x 64;
#X obj 217 41 table \$1-pos-y 64;
#X obj 217 63 table \$1-vel-y 64;
#X obj 217 85 table \$1-force-y 64;
#X text 67 17 Mass tables;
#X text 60 168 Link tables;
#X obj 60 187 table \$1-link-m1 64;
#X obj 60 209 table \$1-link-m2 64;
#X obj 60 231 table \$1-link-k 64;
#X obj 60 253 table \$1-link-D 64;
#X obj 59 276 table \$1-link-force-x 64;
#X obj 59 295 table \$1-link-force-y 64;
#X text 209 185 index of connected mass 1;
#X text 210 208 index of connected mass 2;
#X obj 62 138 table \$1-mobile 64;
#X text 371 41 position;
#X text 369 62 velocity;
#X text 183 117 mass;
#X text 220 139 mobile = 1 \, immobile = 0;
#X text 210 233 k of link;
#X text 209 252 D of link (velocity dependent damping in link direction)
;
#X text 245 276 link forces;
#X text 384 85 force accumulators;
#X obj 59 319 table \$1-link-length 64;
#X text 242 319 link lengths;
#X restore 265 185 pd particle-system-state;
#X obj 24 49 inlet;
#X obj 199 50 inlet;
#X obj 483 49 inlet;
#X text 24 29 bang masses;
#X text 187 24 bang links;
#X text 483 29 ctl;
#N canvas 185 0 1057 657 physigs-masses 0;
#X obj 71 21 inlet;
#X obj 383 106 outlet;
#X text 278 369 friction;
#X obj 403 370 tabreceive~ \$1-mass;
#X text 419 388 vdot = f/m;
#X obj 387 389 /~;
#X text 242 264 xdot = v;
#X text 71 260 get state;
#X obj 71 473 +~;
#X text 99 476 x + xdot;
#X obj 227 473 +~;
#X text 255 472 v + vdot;
#X text 70 622 set new position;
#X text 165 586 set new velocity;
#X obj 310 52 bang~;
#N canvas 181 14 631 450 checkbounds 0;
#X obj 32 57 inlet~;
#X obj 462 95 inlet~;
#X text 465 71 velocity;
#X text 25 33 position;
#X obj 110 320 outlet~;
#X obj 110 298 *~;
#X obj 158 72 r \$0-xmin;
#X obj 222 72 r \$0-xmax;
#X obj 110 251 -~ 1;
#X obj 109 225 *~ 2;
#X obj 134 129 r \$0-bounce;
#X msg 167 193 2;
#X msg 191 223 1;
#X obj 134 169 select 0 1;
#X msg 134 192 1;
#X msg 156 222 0;
#X obj 33 321 outlet~;
#X obj 109 101 between~ -500 500;
#X connect 0 0 16 0;
#X connect 0 0 17 0;
#X connect 1 0 5 1;
#X connect 5 0 4 0;
#X connect 6 0 17 1;
#X connect 7 0 17 2;
#X connect 8 0 5 0;
#X connect 9 0 8 0;
#X connect 10 0 13 0;
#X connect 11 0 9 1;
#X connect 12 0 8 1;
#X connect 13 0 14 0;
#X connect 13 0 15 0;
#X connect 13 1 11 0;
#X connect 13 1 12 0;
#X connect 14 0 9 1;
#X connect 15 0 8 1;
#X connect 17 0 9 0;
#X restore 70 539 pd checkbounds;
#X obj 228 370 *~ 0.99;
#X text 770 369 friction;
#X obj 895 370 tabreceive~ \$1-mass;
#X text 911 388 vdot = f/m;
#X obj 879 389 /~;
#X text 734 264 xdot = v;
#X text 565 260 get state;
#X obj 563 473 +~;
#X text 591 472 x + xdot;
#X obj 719 469 +~;
#X text 747 472 v + vdot;
#X text 570 622 set new position;
#X text 659 572 set new velocity;
#N canvas 181 14 631 450 checkbounds 0;
#X obj 46 61 inlet~;
#X obj 480 86 inlet~;
#X text 483 62 velocity;
#X text 39 37 position;
#X obj 110 360 outlet~;
#X obj 110 348 *~;
#X obj 111 260 -~ 1;
#X obj 110 234 *~ 2;
#X obj 222 72 r \$0-ymax;
#X obj 158 72 r \$0-ymin;
#X obj 135 138 r \$0-bounce;
#X msg 168 202 2;
#X msg 192 232 1;
#X obj 135 178 select 0 1;
#X msg 135 201 1;
#X msg 157 231 0;
#X obj 46 360 outlet~;
#X obj 109 101 between~ -500 500;
#X connect 0 0 16 0;
#X connect 0 0 17 0;
#X connect 1 0 5 1;
#X connect 5 0 4 0;
#X connect 6 0 5 0;
#X connect 7 0 6 0;
#X connect 8 0 17 2;
#X connect 9 0 17 1;
#X connect 10 0 13 0;
#X connect 11 0 7 1;
#X connect 12 0 6 1;
#X connect 13 0 14 0;
#X connect 13 0 15 0;
#X connect 13 1 11 0;
#X connect 13 1 12 0;
#X connect 14 0 7 1;
#X connect 15 0 6 1;
#X connect 17 0 7 0;
#X restore 564 528 pd checkbounds;
#X obj 720 370 *~ 0.99;
#X obj 71 280 tabreceive~ \$1-pos-x;
#X obj 227 288 tabreceive~ \$1-vel-x;
#X obj 387 288 tabreceive~ \$1-force-x;
#X obj 310 128 s \$1-force-x;
#X obj 310 153 s \$1-force-y;
#X obj 165 565 tabsend~ \$1-vel-x;
#X obj 70 601 tabsend~ \$1-pos-x;
#X obj 565 280 tabreceive~ \$1-pos-y;
#X obj 719 288 tabreceive~ \$1-vel-y;
#X obj 879 288 tabreceive~ \$1-force-y;
#X obj 564 598 tabsend~ \$1-pos-y;
#X obj 659 551 tabsend~ \$1-vel-y;
#X msg 310 106 const 0;
#X obj 310 179 s \$1-link-force-x;
#X obj 310 202 s \$1-link-force-y;
#X obj 879 343 *~;
#X obj 388 343 *~;
#X obj 404 312 tabreceive~ \$1-mobile;
#X obj 897 312 tabreceive~ \$1-mobile;
#X obj 267 343 r \$0-drag;
#X obj 759 343 r \$0-drag;
#N canvas 0 0 744 646 clip-x 0;
#X obj 151 165 clip~ -500 500;
#X obj 191 139 r \$0-xmin;
#X obj 256 139 r \$0-xmax;
#X obj 152 89 inlet~;
#X obj 152 210 outlet~;
#X connect 0 0 4 0;
#X connect 1 0 0 1;
#X connect 2 0 0 2;
#X connect 3 0 0 0;
#X restore 70 561 pd clip-x;
#N canvas 0 0 589 427 clip-y 0;
#X obj 151 165 clip~ -500 500;
#X obj 152 89 inlet~;
#X obj 152 210 outlet~;
#X obj 198 122 r \$0-ymin;
#X obj 246 141 r \$0-ymax;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X connect 3 0 0 1;
#X connect 4 0 0 2;
#X restore 564 576 pd clip-y;
#X obj 720 329 *~;
#X obj 227 329 *~;
#X obj 71 176 switch~;
#X msg 85 150 set \$1 1 1;
#N canvas 0 0 456 205 dsp-guard 0;
#X obj 105 49 r pd;
#X obj 105 70 route dsp;
#X obj 66 91 spigot;
#X obj 66 26 inlet;
#X obj 66 119 outlet;
#X text 123 26 blocks messages while dsp is off;
#X msg 121 91 1;
#X connect 0 0 1 0;
#X connect 1 0 2 1;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 6 0 2 1;
#X restore 71 100 pd dsp-guard;
#X obj 71 78 b;
#X obj 85 128 r \$0-num-masses;
#X text 310 32 clean up after dsp block;
#X text 418 152 reset forces;
#X connect 0 0 59 0;
#X connect 3 0 5 1;
#X connect 5 0 10 1;
#X connect 8 0 15 0;
#X connect 10 0 15 1;
#X connect 14 0 43 0;
#X connect 14 0 1 0;
#X connect 15 0 52 0;
#X connect 15 1 36 0;
#X connect 16 0 8 1;
#X connect 16 0 10 0;
#X connect 18 0 20 1;
#X connect 20 0 25 1;
#X connect 23 0 29 0;
#X connect 25 0 29 1;
#X connect 29 0 53 0;
#X connect 29 1 42 0;
#X connect 30 0 23 1;
#X connect 30 0 25 0;
#X connect 31 0 8 0;
#X connect 32 0 55 0;
#X connect 33 0 47 0;
#X connect 38 0 23 0;
#X connect 39 0 54 0;
#X connect 40 0 46 0;
#X connect 43 0 35 0;
#X connect 43 0 34 0;
#X connect 43 0 44 0;
#X connect 43 0 45 0;
#X connect 46 0 20 0;
#X connect 47 0 5 0;
#X connect 48 0 47 1;
#X connect 48 0 55 1;
#X connect 49 0 46 1;
#X connect 49 0 54 1;
#X connect 50 0 16 1;
#X connect 51 0 30 1;
#X connect 52 0 37 0;
#X connect 53 0 41 0;
#X connect 54 0 30 0;
#X connect 55 0 16 0;
#X connect 57 0 56 0;
#X connect 58 0 56 0;
#X connect 59 0 58 0;
#X connect 60 0 57 0;
#X restore 24 90 pd physigs-masses;
#X obj 483 71 physigs_dispatch \$0 reset;
#X text 33 184 m1 \, m2 \, k \, D;
#X obj 483 159 physigs_dispatch \$0 drag;
#X obj 483 181 physigs_dispatch \$0 bounce;
#X obj 483 93 physigs_dispatch \$0 reset-links;
#X obj 483 115 physigs_dispatch \$0 reset-masses;
#X obj 483 203 physigs_dispatch \$0 xbounds;
#X obj 483 225 physigs_dispatch \$0 ybounds;
#N canvas 126 0 1028 544 init-and-reset 0;
#X obj 530 145 s \$0-num-masses;
#X obj 636 81 f \$3;
#X obj 530 79 f \$2;
#X obj 530 101 select 0;
#X msg 530 120 64;
#X obj 636 103 select 0;
#X msg 636 122 64;
#X obj 636 147 s \$0-num-links;
#N canvas 287 93 748 439 resize-tables 0;
#X obj 329 71 s \$1-link-m1;
#X obj 329 115 s \$1-link-k;
#X obj 329 92 s \$1-link-m2;
#X obj 329 137 s \$1-link-D;
#X obj 328 160 s \$1-link-force-x;
#X obj 328 179 s \$1-link-force-y;
#X obj 328 203 s \$1-link-length;
#X msg 292 43 resize \$1;
#X obj 292 16 r \$0-num-links;
#X obj 187 91 s \$1-pos-y;
#X obj 187 113 s \$1-vel-y;
#X obj 187 135 s \$1-force-y;
#X obj 62 91 s \$1-pos-x;
#X obj 62 113 s \$1-vel-x;
#X obj 62 135 s \$1-force-x;
#X obj 62 167 s \$1-mass;
#X obj 62 188 s \$1-mobile;
#X msg 35 43 resize \$1;
#X obj 35 16 r \$0-num-masses;
#X connect 7 0 0 0;
#X connect 7 0 2 0;
#X connect 7 0 1 0;
#X connect 7 0 3 0;
#X connect 7 0 4 0;
#X connect 7 0 5 0;
#X connect 7 0 6 0;
#X connect 8 0 7 0;
#X connect 17 0 12 0;
#X connect 17 0 13 0;
#X connect 17 0 14 0;
#X connect 17 0 9 0;
#X connect 17 0 10 0;
#X connect 17 0 11 0;
#X connect 17 0 15 0;
#X connect 17 0 16 0;
#X connect 18 0 17 0;
#X restore 530 170 pd resize-tables;
#X obj 530 37 r \$0-lb0;
#X obj 800 25 loadbang;
#X obj 800 52 t b b b b b;
#X obj 888 74 s \$0-lb0;
#X obj 877 95 s \$0-lb1;
#X obj 848 117 s \$0-lb2;
#X obj 822 136 s \$0-lb3;
#X obj 800 166 s \$0-lb4;
#N canvas 287 93 748 439 reset-link-tables 0;
#X obj 303 147 s \$1-link-m1;
#X obj 436 152 s \$1-link-k;
#X obj 303 168 s \$1-link-m2;
#X obj 436 174 s \$1-link-D;
#X obj 435 197 s \$1-link-force-x;
#X obj 435 216 s \$1-link-force-y;
#X obj 435 240 s \$1-link-length;
#X obj 285 9 inlet;
#X msg 285 116 const -1;
#X msg 395 117 const 0;
#X obj 285 30 b;
#X connect 7 0 10 0;
#X connect 8 0 0 0;
#X connect 8 0 2 0;
#X connect 9 0 1 0;
#X connect 9 0 4 0;
#X connect 9 0 5 0;
#X connect 9 0 3 0;
#X connect 9 0 6 0;
#X connect 10 0 8 0;
#X connect 10 0 9 0;
#X restore 59 125 pd reset-link-tables;
#N canvas 287 93 770 383 reset-mass-tables 0;
#X obj 279 183 s \$1-pos-y;
#X obj 279 205 s \$1-vel-y;
#X obj 279 227 s \$1-force-y;
#X obj 154 183 s \$1-pos-x;
#X obj 154 205 s \$1-vel-x;
#X obj 154 227 s \$1-force-x;
#X obj 379 227 s \$1-mass;
#X obj 444 227 s \$1-mobile;
#X obj 284 34 inlet;
#X msg 226 121 const 0;
#X obj 284 55 b;
#X msg 444 191 const 1 \, 0 0;
#X text 443 248 default masses are mobile \, except the first one.
;
#X msg 379 188 const 100;
#X connect 8 0 10 0;
#X connect 9 0 0 0;
#X connect 9 0 1 0;
#X connect 9 0 2 0;
#X connect 9 0 3 0;
#X connect 9 0 4 0;
#X connect 9 0 5 0;
#X connect 10 0 9 0;
#X connect 10 0 13 0;
#X connect 10 0 11 0;
#X connect 11 0 7 0;
#X connect 13 0 6 0;
#X restore 22 77 pd reset-mass-tables;
#X obj 59 103 r \$0-reset-links;
#X obj 22 55 r \$0-reset-masses;
#X obj 301 31 r \$0-reset;
#X obj 301 92 s \$0-reset-masses;
#X obj 328 71 s \$0-reset-links;
#X obj 301 51 t b b;
#X obj 397 27 r \$0-lb1;
#X obj 397 49 s \$0-reset;
#X text 864 25 pool of loadbangs;
#X obj 221 203 r \$0-lb2;
#X obj 221 253 s \$0-drag;
#X msg 221 226 0.99;
#X obj 175 300 r \$0-xbounds;
#X obj 175 327 unpack 0 0;
#X obj 175 374 s \$0-xmin;
#X obj 232 350 s \$0-xmax;
#X obj 302 328 unpack 0 0;
#X obj 302 301 r \$0-ybounds;
#X obj 359 350 s \$0-ymax;
#X obj 302 375 s \$0-ymin;
#X connect 1 0 5 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 3 1 0 0;
#X connect 4 0 0 0;
#X connect 5 0 6 0;
#X connect 5 1 7 0;
#X connect 6 0 7 0;
#X connect 9 0 2 0;
#X connect 9 0 1 0;
#X connect 10 0 11 0;
#X connect 11 0 16 0;
#X connect 11 1 15 0;
#X connect 11 2 14 0;
#X connect 11 3 13 0;
#X connect 11 4 12 0;
#X connect 19 0 17 0;
#X connect 20 0 18 0;
#X connect 21 0 24 0;
#X connect 24 0 22 0;
#X connect 24 1 23 0;
#X connect 25 0 26 0;
#X connect 28 0 30 0;
#X connect 30 0 29 0;
#X connect 31 0 32 0;
#X connect 32 0 33 0;
#X connect 32 1 34 0;
#X connect 35 0 38 0;
#X connect 35 1 37 0;
#X connect 36 0 35 0;
#X restore 42 250 pd init-and-reset;
#X obj 483 137 physigs_dispatch \$0 add-link;
#N canvas 281 74 666 313 stuff 0;
#X msg 90 159 0;
#X msg 123 159 0.5;
#X msg 156 159 0.85;
#X msg 244 160 1;
#X msg 203 159 0.95;
#X msg 104 142 0.1;
#X msg 137 141 0.3;
#X obj 200 106 s \$1-link-k;
#X msg 200 85 const \$1 \, 0 0 \, 63 0;
#X floatatom 200 65 5 0 0 0 - - -;
#X obj 203 45 hsl 128 15 0 10 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 0 1;
#X obj 55 104 hsl 128 15 1 0 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 0 1;
#X floatatom 52 126 5 0 0 0 - - -;
#X obj 306 160 s \$1-link-length;
#X floatatom 306 121 5 0 0 0 - - -;
#X obj 444 121 s \$1-link-D;
#X msg 444 94 const \$1;
#X floatatom 444 73 5 0 0 0 - - -;
#X obj 444 52 / 100;
#X floatatom 444 35 5 0 0 0 - - -;
#X obj 90 186 s \$0-drag;
#X msg 306 139 const \$1;
#X connect 0 0 20 0;
#X connect 1 0 20 0;
#X connect 2 0 20 0;
#X connect 3 0 20 0;
#X connect 4 0 20 0;
#X connect 5 0 20 0;
#X connect 6 0 20 0;
#X connect 8 0 7 0;
#X connect 9 0 8 0;
#X connect 10 0 9 0;
#X connect 11 0 12 0;
#X connect 12 0 20 0;
#X connect 14 0 21 0;
#X connect 16 0 15 0;
#X connect 17 0 16 0;
#X connect 18 0 17 0;
#X connect 19 0 18 0;
#X connect 21 0 13 0;
#X restore 482 349 pd stuff;
#X obj 42 206 r \$0-add-link;
#X obj 483 247 physigs_dispatch \$0 table;
#N canvas 0 0 450 300 send-table 0;
#X obj 153 36 r \$0-table;
#X obj 153 63 list split 1;
#X obj 272 126 makefilename \$1-%d;
#X obj 153 92 route symbol float;
#X obj 153 126 makefilename \$1-%s;
#X obj 153 169 t b a;
#X obj 153 264 send;
#X obj 153 203 list append;
#X obj 153 228 list trim;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 1 1 7 1;
#X connect 2 0 5 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 7 0;
#X connect 5 1 6 1;
#X connect 7 0 8 0;
#X connect 8 0 6 0;
#X restore 43 289 pd send-table;
#N canvas 0 0 818 508 auto-link-length 0;
#X obj 71 21 inlet;
#X obj 321 142 outlet;
#X obj 103 185 switch~;
#X msg 103 124 1;
#X msg 150 122 0;
#N canvas 0 0 450 300 print-it 0;
#X obj 77 77 inlet;
#X obj 77 198 outlet;
#X obj 113 159 print switch;
#X obj 208 102 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 113 136 spigot;
#X connect 0 0 4 0;
#X connect 0 0 1 0;
#X connect 3 0 4 1;
#X connect 4 0 2 0;
#X coords 0 -1 1 1 130 20 1 100 100;
#X restore 103 161 pd print-it;
#X obj 71 62 t b b;
#X text 148 46 switch off after one block;
#X obj 150 67 bang~;
#X obj 506 313 tabread~ \$1-pos-y;
#X obj 367 311 tabread~ \$1-pos-y;
#X obj 232 310 tabread~ \$1-pos-x;
#X obj 72 308 tabread~ \$1-pos-x;
#X obj 71 215 spigot;
#X obj 120 215 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 72 257 tabreceive~ \$1-link-m2;
#X obj 232 257 tabreceive~ \$1-link-m1;
#X msg 167 206 set \$1 1 1;
#X obj 167 185 r \$0-num-links;
#N canvas 292 57 436 349 get-vector-length-and-diff 0;
#X obj 81 64 inlet~;
#X obj 134 64 inlet~;
#X obj 221 65 inlet~;
#X obj 273 65 inlet~;
#X text 86 43 x1;
#X text 135 44 x2;
#X text 220 46 y1;
#X text 274 49 y2;
#X obj 82 128 -~;
#X obj 221 98 -~;
#X obj 220 126 *~;
#X obj 82 152 *~;
#X obj 81 186 +~;
#X obj 81 216 sqrt~;
#X text 27 217 |p2-p1|;
#X obj 81 246 outlet~;
#X obj 174 247 outlet~;
#X obj 267 245 outlet~;
#X connect 0 0 8 0;
#X connect 1 0 8 1;
#X connect 2 0 9 0;
#X connect 3 0 9 1;
#X connect 8 0 11 0;
#X connect 8 0 11 1;
#X connect 8 0 16 0;
#X connect 9 0 10 0;
#X connect 9 0 10 1;
#X connect 9 0 17 0;
#X connect 10 0 12 1;
#X connect 11 0 12 0;
#X connect 12 0 13 0;
#X connect 13 0 15 0;
#X restore 71 364 pd get-vector-length-and-diff;
#X obj 72 428 tabsend~ \$1-link-length;
#X connect 0 0 6 0;
#X connect 3 0 5 0;
#X connect 4 0 5 0;
#X connect 5 0 2 0;
#X connect 6 0 13 0;
#X connect 6 1 3 0;
#X connect 8 0 4 0;
#X connect 8 0 1 0;
#X connect 9 0 19 3;
#X connect 10 0 19 2;
#X connect 11 0 19 1;
#X connect 12 0 19 0;
#X connect 14 0 13 1;
#X connect 15 0 12 0;
#X connect 15 0 10 0;
#X connect 16 0 11 0;
#X connect 16 0 9 0;
#X connect 17 0 2 0;
#X connect 18 0 17 0;
#X connect 19 0 20 0;
#X restore 232 351 pd auto-link-length;
#X obj 232 326 r \$0-auto-link-length;
#X obj 483 270 physigs_dispatch \$0 auto-link-length;
#X obj 483 293 physigs_dispatch \$0 save;
#X obj 483 315 physigs_dispatch \$0 load;
#N canvas 280 161 979 443 save-load 1;
#X msg 87 131 pos-x \, pos-y \, mass \, mobile \, link-m1 \, link-m2
\, link-k \, link-d \, link-length;
#X text 274 108 This is what we save;
#X obj 87 61 r \$0-save;
#X obj 87 89 list;
#X obj 87 109 t b a;
#X text 162 60 must be a directory name!;
#X obj 87 198 list prepend \$1;
#X obj 87 167 t a a;
#X obj 87 231 list append;
#X msg 87 252 write \$3/\$2.dat \$1-\$2;
#X obj 87 282 list split 2;
#X obj 87 314 list trim;
#X obj 87 341 send;
#X text 249 251 tbalename last!;
#X msg 517 125 pos-x \, pos-y \, mass \, mobile \, link-m1 \, link-m2
\, link-k \, link-d \, link-length;
#X text 704 102 This is what we save;
#X obj 517 83 list;
#X obj 517 103 t b a;
#X text 592 54 must be a directory name!;
#X obj 517 192 list prepend \$1;
#X obj 517 161 t a a;
#X obj 517 225 list append;
#X obj 517 276 list split 2;
#X obj 517 308 list trim;
#X obj 517 335 send;
#X text 679 245 tbalename last!;
#X obj 517 55 r \$0-load;
#X msg 517 246 read \$3/\$2.dat \$1-\$2;
#X msg 451 49 DIRNAME;
#X connect 0 0 7 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 0 0;
#X connect 4 1 8 1;
#X connect 6 0 8 0;
#X connect 7 0 6 0;
#X connect 8 0 9 0;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 10 1 12 1;
#X connect 11 0 12 0;
#X connect 14 0 20 0;
#X connect 16 0 17 0;
#X connect 17 0 14 0;
#X connect 17 1 21 1;
#X connect 19 0 21 0;
#X connect 20 0 19 0;
#X connect 21 0 27 0;
#X connect 22 0 23 0;
#X connect 22 1 24 1;
#X connect 23 0 24 0;
#X connect 26 0 16 0;
#X connect 27 0 22 0;
#X connect 28 0 16 0;
#X restore 552 349 pd save-load;
#X connect 0 0 1 0;
#X connect 3 0 2 1;
#X connect 5 0 11 0;
#X connect 6 0 0 0;
#X connect 7 0 12 0;
#X connect 12 0 16 0;
#X connect 14 0 15 0;
#X connect 15 0 18 0;
#X connect 16 0 17 0;
#X connect 17 0 21 0;
#X connect 18 0 19 0;
#X connect 19 0 24 0;
#X connect 21 0 14 0;
#X connect 23 0 2 0;
#X connect 24 0 28 0;
#X connect 27 0 26 0;
#X connect 28 0 29 0;
#X connect 29 0 30 0;
